<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luxury Brand Identity | Gemini Power</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        :root {
            --gold: #c5a059;
            --black: #121212;
            --white: #ffffff;
            --soft-gray: #f9f9f9;
        }

        * {
            box-sizing: border-box;
        }

        body { 
            font-family: 'Segoe UI', Tahoma, Arial, sans-serif; 
            background: linear-gradient(135deg, var(--soft-gray) 0%, #e8e8e8 100%);
            color: var(--black);
            margin: 0; 
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 850px;
            margin: 40px auto;
            background: var(--white);
            padding: 40px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            border-top: 6px solid var(--gold);
            border-radius: 8px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        h1 { 
            font-weight: 300; 
            letter-spacing: 2px; 
            color: var(--black);
            margin-bottom: 10px;
            font-size: 32px;
        }

        .subtitle {
            color: var(--gold);
            font-size: 14px;
            letter-spacing: 1px;
        }

        .form-group { 
            display: flex; 
            gap: 15px; 
            margin: 30px 0;
            flex-wrap: wrap;
        }

        input { 
            flex: 1; 
            min-width: 250px;
            padding: 16px; 
            border: 2px solid #e0e0e0; 
            font-size: 16px; 
            border-radius: 6px; 
            outline: none;
            transition: all 0.3s;
            font-family: inherit;
        }

        input:focus { 
            border-color: var(--gold);
            box-shadow: 0 0 0 4px rgba(197, 160, 89, 0.1);
            transform: translateY(-2px);
        }

        .actions { 
            display: flex; 
            gap: 12px;
            flex-wrap: wrap;
        }

        button { 
            flex: 1; 
            min-width: 200px;
            padding: 16px 24px; 
            cursor: pointer; 
            border: none;
            font-weight: 600; 
            font-size: 16px; 
            border-radius: 6px; 
            transition: all 0.3s;
            font-family: inherit;
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        .btn-gen { 
            background: linear-gradient(135deg, var(--black) 0%, #2a2a2a 100%);
            color: white; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .btn-gen:hover:not(:disabled) { 
            background: linear-gradient(135deg, #2a2a2a 0%, #444 100%);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .btn-pdf { 
            background: linear-gradient(135deg, var(--gold) 0%, #b89048 100%);
            color: white; 
            display: none;
            box-shadow: 0 4px 15px rgba(197, 160, 89, 0.3);
        }

        .btn-pdf:hover {
            background: linear-gradient(135deg, #b89048 0%, #a68040 100%);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(197, 160, 89, 0.4);
        }

        #output { 
            margin-top: 40px; 
            padding: 35px; 
            border: 2px solid #f0f0f0;
            background: #fefefe; 
            line-height: 1.9; 
            display: none;
            font-size: 17px; 
            color: #333; 
            border-radius: 8px;
            box-shadow: inset 0 2px 8px rgba(0,0,0,0.03);
        }

        .loading { 
            display: none; 
            text-align: center; 
            color: var(--gold); 
            margin: 30px 0; 
            font-weight: 600;
            font-size: 18px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--gold);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        #output strong { 
            color: var(--gold); 
            display: block; 
            margin-top: 25px;
            margin-bottom: 12px;
            font-size: 22px;
            border-bottom: 3px solid var(--gold);
            padding-bottom: 10px;
            font-weight: 600;
        }

        #output p {
            margin: 12px 0;
            text-align: justify;
        }

        #output ul {
            margin: 15px 0;
            padding-right: 25px;
        }

        #output li {
            margin: 10px 0;
            line-height: 1.7;
        }

        .error-message {
            color: #c62828;
            background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
            padding: 20px;
            border-radius: 8px;
            border-left: 5px solid #c62828;
            margin: 20px 0;
            font-size: 15px;
            line-height: 1.8;
        }

        .error-message strong {
            display: block;
            margin-bottom: 10px;
            font-size: 18px;
            color: var(--black);
        }

        .success-badge {
            display: inline-block;
            background: linear-gradient(135deg, var(--gold) 0%, #b89048 100%);
            color: white;
            padding: 8px 20px;
            border-radius: 25px;
            font-size: 14px;
            margin-bottom: 25px;
            font-weight: 600;
            box-shadow: 0 3px 10px rgba(197, 160, 89, 0.3);
        }

        .info-box {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border-left: 5px solid #2196f3;
            padding: 18px;
            margin: 25px 0;
            border-radius: 6px;
            font-size: 14px;
            line-height: 1.7;
        }

        .tip {
            background: linear-gradient(135deg, #fff8e1 0%, #ffecb3 100%);
            border-left: 5px solid #ffa726;
            padding: 15px;
            margin: 20px 0;
            border-radius: 6px;
            font-size: 14px;
        }

        @media (max-width: 600px) {
            .container {
                padding: 25px;
                margin: 20px auto;
            }

            h1 {
                font-size: 24px;
            }

            .form-group {
                flex-direction: column;
            }

            input {
                min-width: 100%;
            }

            button {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>ğŸ¨ Ù…ØµÙ…Ù… Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ© Ø§Ù„Ø°ÙƒÙŠ</h1>
        <div class="subtitle">Ù…Ø¯Ø¹ÙˆÙ… Ø¨ØªÙ‚Ù†ÙŠØ© Gemini AI</div>
    </div>
    
    <div class="form-group">
        <input id="brand" placeholder="âœï¸ Ø§Ø³Ù… Ø§Ù„Ø¨Ø±Ø§Ù†Ø¯ (Ù…Ø«Ù„Ø§Ù‹: Ù„ÙˆØ³ÙŠÙ†)" autocomplete="off">
        <input id="industry" placeholder="ğŸ¢ Ø§Ù„Ù…Ø¬Ø§Ù„ (Ù…Ø«Ù„Ø§Ù‹: Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„ÙØ§Ø®Ø±Ø©)" autocomplete="off">
    </div>
    
    <div class="actions">
        <button class="btn-gen" id="generateBtn" onclick="generateWithGemini()">âœ¨ ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ÙŠ</button>
        <button id="downloadBtn" class="btn-pdf" onclick="downloadPDF()">ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¯Ù„ÙŠÙ„ (PDF)</button>
    </div>
    
    <div id="loading" class="loading">
        <div class="spinner"></div>
        Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØµÙ…ÙŠÙ… Ø¨ÙˆØ§Ø³Ø·Ø© Gemini AI
    </div>
    
    <div id="output"></div>
    
    <div class="tip" style="margin-top: 30px;">
        ğŸ’¡ <strong>Ù†ØµÙŠØ­Ø©:</strong> Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£ÙØ¶Ù„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ØŒ ÙƒÙ† Ù…Ø­Ø¯Ø¯Ø§Ù‹ ÙÙŠ ÙˆØµÙ Ù…Ø¬Ø§Ù„ Ø¹Ù…Ù„Ùƒ. Ù…Ø«Ù„Ø§Ù‹: "Ø³Ø§Ø¹Ø§Øª Ø³ÙˆÙŠØ³Ø±ÙŠØ© ÙØ§Ø®Ø±Ø©" Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† "Ø³Ø§Ø¹Ø§Øª" ÙÙ‚Ø·.
    </div>
</div>

<script>
// ============================================
// Gemini API Configuration
// ============================================
const API_KEY = "AIzaSyBjOa3C35JoOuZItLcjfDXbV4XTeGPHzZw";
const API_ENDPOINT = "https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent";

async function generateWithGemini() {
    const brand = document.getElementById('brand').value.trim();
    const industry = document.getElementById('industry').value.trim();
    const outputDiv = document.getElementById('output');
    const loadingDiv = document.getElementById('loading');
    const downloadBtn = document.getElementById('downloadBtn');
    const generateBtn = document.getElementById('generateBtn');

    // ============================================
    // Validation
    // ============================================
    if (!brand || !industry) {
        showError("âš ï¸ Ù„Ø·ÙØ§Ù‹ØŒ Ø§Ù…Ù„Ø£ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ù‚Ø¨Ù„ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©");
        return;
    }

    // ============================================
    // UI State Management
    // ============================================
    loadingDiv.style.display = "block";
    outputDiv.style.display = "none";
    downloadBtn.style.display = "none";
    generateBtn.disabled = true;

    // ============================================
    // Enhanced Prompt for Gemini
    // ============================================
    const promptText = `Ø£Ù†Øª Ù…ØµÙ…Ù… Ø¹Ù„Ø§Ù…Ø§Øª ØªØ¬Ø§Ø±ÙŠØ© Ø¹Ø§Ù„Ù…ÙŠ Ø®Ø¨ÙŠØ± ÙˆÙ…ØªØ®ØµØµ ÙÙŠ Ø§Ù„Ù‡ÙˆÙŠØ§Øª Ø§Ù„Ø¨ØµØ±ÙŠØ© Ø§Ù„ÙØ§Ø®Ø±Ø©. Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø¯Ù„ÙŠÙ„ Ù‡ÙˆÙŠØ© Ø¨ØµØ±ÙŠØ© ÙˆØ§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ø­ØªØ±Ø§ÙÙŠ ÙˆØ´Ø§Ù…Ù„ ÙˆÙ…ÙØµÙ‘Ù„ Ù„Ø¨Ø±Ø§Ù†Ø¯ "${brand}" ÙÙŠ Ù…Ø¬Ø§Ù„ "${industry}".

ÙŠØ¬Ø¨ Ø£Ù† ÙŠØªØ¶Ù…Ù† Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„ØªØ§Ù„ÙŠØ© Ø¨Ø´ÙƒÙ„ Ù…Ù†Ø¸Ù… ÙˆÙ…ÙØµÙ‘Ù„ Ù„Ù„ØºØ§ÙŠØ©:

**1. Ø¬ÙˆÙ‡Ø± Ø§Ù„Ø¨Ø±Ø§Ù†Ø¯ (Brand Essence)**
- Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø¬ÙˆÙ‡Ø±ÙŠØ© (3-4 Ù‚ÙŠÙ…)
- Ø§Ù„Ø´Ø®ØµÙŠØ© ÙˆØ§Ù„Ø·Ø§Ø¨Ø¹ (Ø§Ø°ÙƒØ± ØµÙØ§Øª Ù…Ø­Ø¯Ø¯Ø©)
- Ø§Ù„ÙˆØ¹Ø¯ Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡ (Ø±Ø³Ø§Ù„Ø© ÙˆØ§Ø¶Ø­Ø©)

**2. Ù‚ØµØ© Ø§Ù„Ø¨Ø±Ø§Ù†Ø¯ (Brand Story)**
- Ù‚ØµØ© Ø¥Ù†Ø´Ø§Ø¦ÙŠØ© Ù…Ù„Ù‡Ù…Ø© ÙˆØ¹Ø§Ø·ÙÙŠØ© (200 ÙƒÙ„Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„)
- Ø§Ù„Ø±Ø¤ÙŠØ©: Ø¥Ù„Ù‰ Ø£ÙŠÙ† Ù†ØªØ¬Ù‡
- Ø§Ù„Ø±Ø³Ø§Ù„Ø©: Ù„Ù…Ø§Ø°Ø§ Ù†ÙˆØ¬Ø¯
- Ø§Ù„ØªÙ…ÙŠØ²: Ù…Ø§ ÙŠÙ…ÙŠØ²Ù†Ø§ Ø¹Ù† Ø§Ù„Ù…Ù†Ø§ÙØ³ÙŠÙ†

**3. Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ù„ÙˆØ§Ù† (Color Palette)**
- Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ø§Ù„Ø£ÙˆÙ„ Ù…Ø¹ ÙƒÙˆØ¯ Hex (Ù…Ø«Ù„Ø§Ù‹: #1A1A1A)
- Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ø§Ù„Ø«Ø§Ù†ÙŠ Ù…Ø¹ ÙƒÙˆØ¯ Hex
- Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ Ø§Ù„Ø£ÙˆÙ„ Ù…Ø¹ ÙƒÙˆØ¯ Hex
- Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ Ø§Ù„Ø«Ø§Ù†ÙŠ Ù…Ø¹ ÙƒÙˆØ¯ Hex
- Ø£Ù„ÙˆØ§Ù† Ø¥Ø¶Ø§ÙÙŠØ© (2-3 Ø£Ù„ÙˆØ§Ù†) Ù…Ø¹ Ø£ÙƒÙˆØ§Ø¯ Hex
- Ø´Ø±Ø­ Ù…ØªÙ‰ ÙˆÙƒÙŠÙ ØªØ³ØªØ®Ø¯Ù… ÙƒÙ„ Ù„ÙˆÙ† Ø¨Ø§Ù„ØªÙØµÙŠÙ„
- Ø£Ù…Ø«Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª

**4. Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© ÙˆØ§Ù„Ø®Ø·ÙˆØ· (Typography)**
- Ø§Ù„Ø®Ø· Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† (Ø§Ø°ÙƒØ± Ø§Ø³Ù… Ø§Ù„Ø®Ø·)
- Ø§Ù„Ø®Ø· Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ Ù„Ù„Ù†ØµÙˆØµ (Ø§Ø°ÙƒØ± Ø§Ø³Ù… Ø§Ù„Ø®Ø·)
- Ø£Ø­Ø¬Ø§Ù… Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©
- Ø§Ù„Ø£ÙˆØ²Ø§Ù† Ø§Ù„Ù…ÙˆØµÙ‰ Ø¨Ù‡Ø§
- Ø£Ù…Ø«Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚

**5. Ø£Ø³Ù„ÙˆØ¨ Ø§Ù„ØªØµÙˆÙŠØ± Ø§Ù„ÙÙˆØªÙˆØºØ±Ø§ÙÙŠ (Photography Style)**
- Ù†ÙˆØ¹ Ø§Ù„ØªØµÙˆÙŠØ± Ø§Ù„Ù…ÙˆØµÙ‰ Ø¨Ù‡ (lifestyle, product, editorial, etc.)
- Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø© Ø§Ù„Ù…ÙØ¶Ù„Ø© (Ø·Ø¨ÙŠØ¹ÙŠØ©ØŒ Ø§Ø³ØªÙˆØ¯ÙŠÙˆØŒ etc.)
- Ø§Ù„Ø£Ù„ÙˆØ§Ù† ÙˆØ§Ù„ÙÙ„Ø§ØªØ±
- Ø§Ù„Ù…ÙˆØ§Ø¶ÙŠØ¹ ÙˆØ§Ù„Ø£Ø¬ÙˆØ§Ø¡
- Ù…Ø§ ÙŠØ¬Ø¨ ØªØ¬Ù†Ø¨Ù‡
- Ø£Ù…Ø«Ù„Ø© ÙˆØµÙÙŠØ©

**6. Ù†Ø¨Ø±Ø© Ø§Ù„ØµÙˆØª (Tone of Voice)**
- ÙƒÙŠÙ ÙŠØªØ­Ø¯Ø« Ø§Ù„Ø¨Ø±Ø§Ù†Ø¯ (Ø±Ø³Ù…ÙŠØŒ ÙˆØ¯ÙˆØ¯ØŒ ÙØ®Ù…ØŒ etc.)
- Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ© (10 ÙƒÙ„Ù…Ø§Øª)
- Ø¹Ø¨Ø§Ø±Ø§Øª Ù†Ù…ÙˆØ°Ø¬ÙŠØ© (5 Ø£Ù…Ø«Ù„Ø©)
- Ù…Ø§ ÙŠØ¬Ø¨ ØªØ¬Ù†Ø¨Ù‡ (5 Ø£Ù…Ø«Ù„Ø©)
- Ø£Ø³Ù„ÙˆØ¨ Ø§Ù„ÙƒØªØ§Ø¨Ø© ÙÙŠ ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„ØªÙˆØ§ØµÙ„

**7. Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø¨ØµØ±ÙŠØ© Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©**
- Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª (flat, outline, 3D, etc.)
- Ø§Ù„Ø£Ù†Ù…Ø§Ø· ÙˆØ§Ù„Ø²Ø®Ø§Ø±Ù
- Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø³Ø§Ø­Ø§Øª Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡
- Ø§Ù„Ø´Ø¨ÙƒØ§Øª ÙˆØ§Ù„ØªØ®Ø·ÙŠØ·Ø§Øª

**8. Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ©**
- Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¹Ù…Ù„
- ØªØ±ÙˆÙŠØ³Ø© Ø§Ù„Ø£ÙˆØ±Ø§Ù‚
- Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ
- ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ

Ø§ÙƒØªØ¨ Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„ÙØµØ­Ù‰ Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø±Ø§Ù‚Ù ÙˆØ§Ø­ØªØ±Ø§ÙÙŠ Ù„Ù„ØºØ§ÙŠØ©. Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù†Ø¬ÙˆÙ… Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬Ø© (**) ÙÙ‚Ø· Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©. Ø§Ø¬Ø¹Ù„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ØºÙ†ÙŠØ§Ù‹ Ø¨Ø§Ù„ØªÙØ§ØµÙŠÙ„ ÙˆØ§Ù„Ø£Ù…Ø«Ù„Ø© Ø§Ù„Ø¹Ù…Ù„ÙŠØ©. Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ 1500 ÙƒÙ„Ù…Ø©.`;

    try {
        console.log('ğŸš€ Ø¨Ø¯Ø¡ Ø§Ù„Ø·Ù„Ø¨ Ø¥Ù„Ù‰ Gemini API...');
        console.log('ğŸ“ Brand:', brand);
        console.log('ğŸ“ Industry:', industry);
        
        // ============================================
        // API Request Configuration
        // ============================================
        const requestBody = {
            contents: [{
                parts: [{
                    text: promptText
                }]
            }],
            generationConfig: {
                temperature: 0.85,
                topK: 40,
                topP: 0.95,
                maxOutputTokens: 8192,
            },
            safetySettings: [
                {
                    category: "HARM_CATEGORY_HARASSMENT",
                    threshold: "BLOCK_NONE"
                },
                {
                    category: "HARM_CATEGORY_HATE_SPEECH",
                    threshold: "BLOCK_NONE"
                },
                {
                    category: "HARM_CATEGORY_SEXUALLY_EXPLICIT",
                    threshold: "BLOCK_NONE"
                },
                {
                    category: "HARM_CATEGORY_DANGEROUS_CONTENT",
                    threshold: "BLOCK_NONE"
                }
            ]
        };

        const url = `${API_ENDPOINT}?key=${API_KEY}`;
        
        const response = await fetch(url, {
            method: "POST",
            headers: { 
                "Content-Type": "application/json",
            },
            body: JSON.stringify(requestBody),
            mode: 'cors'
        });

        console.log('ğŸ“¡ Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©:', response.status);

        if (!response.ok) {
            const errorData = await response.json().catch(() => ({}));
            console.error('âŒ Ø®Ø·Ø£ API:', errorData);
            
            if (response.status === 403) {
                throw new Error('Ø§Ù„Ù…ÙØªØ§Ø­ ØºÙŠØ± ØµØ§Ù„Ø­ Ø£Ùˆ ØºÙŠØ± Ù…ÙØ¹Ù‘Ù„. ØªØ­Ù‚Ù‚ Ù…Ù† Google AI Studio.');
            } else if (response.status === 429) {
                throw new Error('ØªØ¬Ø§ÙˆØ²Øª Ø§Ù„Ø­Ø¯ Ø§Ù„Ù…Ø³Ù…ÙˆØ­. Ø§Ù†ØªØ¸Ø± Ù‚Ù„ÙŠÙ„Ø§Ù‹ Ø«Ù… Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
            } else {
                throw new Error(`Ø®Ø·Ø£ HTTP ${response.status}: ${errorData.error?.message || 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'}`);
            }
        }

        const data = await response.json();
        console.log('âœ… ØªÙ… Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');

        // ============================================
        // Process Response
        // ============================================
        if (data.candidates && data.candidates[0]?.content?.parts[0]?.text) {
            let rawText = data.candidates[0].content.parts[0].text;
            console.log('ğŸ“ Ø·ÙˆÙ„ Ø§Ù„Ù†Øµ:', rawText.length, 'Ø­Ø±Ù');
            
            let formattedText = formatBrandGuide(rawText);
            
            outputDiv.innerHTML = `
                <div class="success-badge">âœ“ ØªÙ… Ø§Ù„ØªÙˆÙ„ÙŠØ¯ Ø¨Ù†Ø¬Ø§Ø­ Ø¨ÙˆØ§Ø³Ø·Ø© Gemini 1.5 Flash</div>
                ${formattedText}
            `;
            outputDiv.style.display = "block";
            downloadBtn.style.display = "block";
            
            setTimeout(() => {
                outputDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 150);
            
        } else if (data.candidates && data.candidates[0]?.finishReason) {
            const reason = data.candidates[0].finishReason;
            console.warn('âš ï¸ Ø³Ø¨Ø¨ Ø§Ù„Ø¥Ù†Ù‡Ø§Ø¡:', reason);
            
            if (reason === 'SAFETY') {
                throw new Error('ØªÙ… Ø­Ø¸Ø± Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¨Ø³Ø¨Ø¨ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù†. Ø­Ø§ÙˆÙ„ Ø¨Ù…Ø¯Ø®Ù„Ø§Øª Ù…Ø®ØªÙ„ÙØ©.');
            } else if (reason === 'MAX_TOKENS') {
                throw new Error('ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù…Ù† Ø§Ù„ÙƒÙ„Ù…Ø§Øª. Ø­Ø§ÙˆÙ„ Ø¨Ø·Ù„Ø¨ Ø£Ù‚ØµØ±.');
            } else {
                throw new Error(`Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ØªÙˆÙ„ÙŠØ¯ Ø¨Ø³Ø¨Ø¨: ${reason}`);
            }
        } else {
            console.error('âŒ Ù‡ÙŠÙƒÙ„ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹:', data);
            throw new Error('Ø§Ø³ØªØ¬Ø§Ø¨Ø© ØºÙŠØ± ØµØ­ÙŠØ­Ø© Ù…Ù† Gemini API');
        }
        
    } catch (error) {
        console.error("âŒ Ø®Ø·Ø£ ÙƒØ§Ù…Ù„:", error);
        
        let errorMessage = "";
        
        if (error.message.includes('Failed to fetch') || error.name === 'TypeError') {
            errorMessage = `
                <strong>âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„</strong><br><br>
                <strong>Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ù…Ø­ØªÙ…Ù„:</strong> Ù…Ø´ÙƒÙ„Ø© CORS Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„Ù…Ù„Ù Ù…Ø¨Ø§Ø´Ø±Ø© Ù…Ù† Ø§Ù„Ù…Ø¬Ù„Ø¯.<br><br>
                
                <strong>Ø§Ù„Ø­Ù„ Ø§Ù„Ù…ÙˆØµÙ‰ Ø¨Ù‡:</strong><br>
                1ï¸âƒ£ Ø§Ø³ØªØ®Ø¯Ù… Ø£Ø­Ø¯ Ù‡Ø°Ù‡ Ø§Ù„Ø·Ø±Ù‚ Ù„ÙØªØ­ Ø§Ù„Ù…Ù„Ù:<br>
                <br>
                <strong>Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ - Python (Ø³Ù‡Ù„Ø©):</strong><br>
                â€¢ Ø§ÙØªØ­ Terminal Ø£Ùˆ Command Prompt<br>
                â€¢ Ø§Ù†ØªÙ‚Ù„ Ù„Ù…Ø¬Ù„Ø¯ Ø§Ù„Ù…Ù„Ù: <code>cd path/to/folder</code><br>
                â€¢ Ø´ØºÙ‘Ù„: <code>python -m http.server 8000</code><br>
                â€¢ Ø§ÙØªØ­ Ø§Ù„Ù…ØªØµÙØ­ Ø¹Ù„Ù‰: <code>http://localhost:8000</code><br>
                <br>
                <strong>Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© - VS Code:</strong><br>
                â€¢ Ø«Ø¨Ù‘Øª Ø¥Ø¶Ø§ÙØ© "Live Server"<br>
                â€¢ Ø§Ø¶ØºØ· Ø¨Ø§Ù„Ø²Ø± Ø§Ù„Ø£ÙŠÙ…Ù† Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù„Ù<br>
                â€¢ Ø§Ø®ØªØ± "Open with Live Server"<br>
                <br>
                <strong>Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø© - Ø§Ø³ØªØ¶Ø§ÙØ© Ù…Ø¬Ø§Ù†ÙŠØ©:</strong><br>
                â€¢ Ø§Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù Ø¹Ù„Ù‰ GitHub Pages Ø£Ùˆ Netlify<br>
                <br>
                2ï¸âƒ£ ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª<br>
                3ï¸âƒ£ Ø¬Ø±Ù‘Ø¨ Ù…ØªØµÙØ­Ø§Ù‹ Ø¢Ø®Ø± (Chrome Ø£Ùˆ Firefox)
            `;
        } else if (error.message.includes('403')) {
            errorMessage = `
                <strong>âš ï¸ Ù…ÙØªØ§Ø­ API ØºÙŠØ± ØµØ­ÙŠØ­</strong><br><br>
                ØªØ­Ù‚Ù‚ Ù…Ù†:<br>
                â€¢ Ø§Ù„Ù…ÙØªØ§Ø­ Ù…ÙƒØªÙˆØ¨ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­<br>
                â€¢ Ø§Ù„Ù…ÙØªØ§Ø­ Ù…ÙØ¹Ù‘Ù„ ÙÙŠ <a href="https://makersuite.google.com/app/apikey" target="_blank">Google AI Studio</a><br>
                â€¢ ØªÙ… ØªÙØ¹ÙŠÙ„ Gemini API Ù„Ù„Ù…ÙØªØ§Ø­
            `;
        } else if (error.message.includes('429')) {
            errorMessage = `
                <strong>â³ ØªØ¬Ø§ÙˆØ² Ø­Ø¯ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</strong><br><br>
                â€¢ Ø§Ù†ØªØ¸Ø± 1-2 Ø¯Ù‚ÙŠÙ‚Ø©<br>
                â€¢ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰<br>
                â€¢ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ù… Ù…ÙØªØ§Ø­ API Ø¢Ø®Ø±
            `;
        } else {
            errorMessage = `
                <strong>âŒ Ø­Ø¯Ø« Ø®Ø·Ø£</strong><br><br>
                ${error.message}
            `;
        }
        
        showError(errorMessage);
        
    } finally {
        loadingDiv.style.display = "none";
        generateBtn.disabled = false;
    }
}

// ============================================
// Format Brand Guide Function
// ============================================
function formatBrandGuide(text) {
    let formatted = text;
    
    // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†
    formatted = formatted.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>');
    
    // ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø³Ø·Ø± Ø§Ù„ÙØ§Ø±ØºØ©
    formatted = formatted.split('\n\n').map(para => {
        if (para.trim()) {
            return '<p>' + para.trim() + '</p>';
        }
        return '';
    }).join('');
    
    // ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù‚ÙˆØ§Ø¦Ù…
    formatted = formatted.replace(/<p>-\s+(.+?)<\/p>/g, '<li>$1</li>');
    formatted = formatted.replace(/(<li>.+?<\/li>)+/g, '<ul>$&</ul>');
    
    // ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ (Hex codes)
    formatted = formatted.replace(/#([0-9A-Fa-f]{6}|[0-9A-Fa-f]{3})/g, 
        '<span style="background:#f5f5f5;padding:2px 8px;border-radius:3px;font-family:monospace;color:var(--gold);font-weight:bold;">#$1</span>');
    
    return formatted;
}

// ============================================
// Show Error Function
// ============================================
function showError(message) {
    const outputDiv = document.getElementById('output');
    outputDiv.innerHTML = `<div class="error-message">${message}</div>`;
    outputDiv.style.display = "block";
}

// ============================================
// Download PDF Function
// ============================================
function downloadPDF() {
    const element = document.getElementById('output');
    const brandName = document.getElementById('brand').value || 'Brand';
    
    const opt = {
        margin:       [0.5, 0.5],
        filename:     `${brandName}_Brand_Guidelines_${Date.now()}.pdf`,
        image:        { type: 'jpeg', quality: 0.98 },
        html2canvas:  { scale: 2, useCORS: true, letterRendering: true },
        jsPDF:        { unit: 'in', format: 'a4', orientation: 'portrait' }
    };

    const downloadBtn = document.getElementById('downloadBtn');
    const originalText = downloadBtn.textContent;
    downloadBtn.textContent = 'â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...';
    downloadBtn.disabled = true;

    html2pdf().set(opt).from(element).save()
        .then(() => {
            downloadBtn.textContent = 'âœ… ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„!';
            setTimeout(() => {
                downloadBtn.textContent = originalText;
                downloadBtn.disabled = false;
            }, 2000);
        })
        .catch(err => {
            console.error('PDF Error:', err);
            downloadBtn.textContent = originalText;
            downloadBtn.disabled = false;
            alert('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ù†Ø´Ø§Ø¡ PDF');
        });
}

// ============================================
// Event Listeners
// ============================================
document.getElementById('brand').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        document.getElementById('industry').focus();
    }
});

document.getElementById('industry').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        generateWithGemini();
    }
});

// ============================================
// Page Load
// ============================================
window.addEventListener('load', () => {
    console.log('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ ØµÙØ­Ø© Ù…ØµÙ…Ù… Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©');
    console.log('ğŸ”‘ API Key:', API_KEY ? 'Ù…ÙØ¹Ø±Ù‘Ù' : 'ØºÙŠØ± Ù…ÙØ¹Ø±Ù‘Ù');
    console.log('ğŸ“ Endpoint:', API_ENDPOINT);
});
</script>

</body>
</html>
